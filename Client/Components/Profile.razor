@*@attribute [Authorize]*@
@inject AuthenticationStateProvider AuthenticationStateProvider
@inject DataAccessService data
@inject IDialogService DialogService
@inject StateAccessService state

<EditForm Model="@_currentMember" OnValidSubmit="HandleValidMemberSubmit" class="pt-5">
    <DataAnnotationsValidator />
    <MudGrid>
        <MudItem xs="12" sm="7" Class="pt-5">
            <MudTextField @bind-Value="@_currentMember.FirstName" Label="First Name" Variant="Variant.Text"></MudTextField>
        </MudItem>
        <MudItem xs="12" sm="7" Class="pt-5">
            <MudTextField @bind-Value="@_currentMember.LastName" Label="Last Name" Variant="Variant.Text"></MudTextField>
        </MudItem>
        <MudItem xs="12" sm="7" Class="pt-5">
            <MudTextField @bind-Value="@_currentMember.MobileNumber" Label="Mobile Number" Variant="Variant.Text"></MudTextField>
        </MudItem>
        <MudItem xs="12" sm="7" Class="pt-5">
            <MudTextField @bind-Value="@_currentMember.Email" Label="Email" Disabled Variant="Variant.Text"></MudTextField>
        </MudItem>
        <MudItem xs="12" sm="7" Class="pt-5">
            <MudTextField @bind-Value="@_currentMember.Gender" Label="Gender" Disabled Variant="Variant.Text"></MudTextField>
        </MudItem>
        <MudItem xs="12" sm="7" Class="pt-5">
            <MudTextField @bind-Value="@_currentMember.PlayLevel" Label="Level" Disabled Variant="Variant.Text"></MudTextField>
        </MudItem>
        <MudItem xs="12" sm="7" Class="pt-5">
            <MudTextField @bind-Value="@_currentMember.PlayScore" Label="Player Score" Disabled Variant="Variant.Text"></MudTextField>
        </MudItem>
        <MudItem xs="12" sm="7" Class="pt-5">
            <MudTextField @bind-Value="@_currentMember.IsAdmin" Label="Admin User" Disabled Variant="Variant.Text"></MudTextField>
        </MudItem>
    </MudGrid>
</EditForm>
<MudPaper Height="200px" Width="100%" Elevation="0">
    <MudContainer MaxWidth="MaxWidth.Small">
        <MudPaper Height="200px" Width="100%" Square="true" Style="background-color:transparent" Elevation="0"></MudPaper>
    </MudContainer>
</MudPaper>


@code {
    private StateAccessService? _state;
    private DataAccessService? _data;
    private entities.Member? _currentMember;
    private bool _success;

    protected override async Task OnInitializedAsync()
    {
        _state = state;
        _currentMember = _state.Member;
        _data = data ?? null;
    }

    private void HandleValidMemberSubmit(EditContext context)
    {
        _success = true;
        StateHasChanged();
    }

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (!firstRender)
        {
            if (_currentMember is null)
            {
                _currentMember = _state.Member;
            }
        }
    }


}